// room script file


// Room 7 - CRÉDITOS (código completo para room_AfterFadeIn)
// Función auxiliar para verificar si un string contiene otro
// Función auxiliar para verificar si un string contiene otro
bool StringContains(String texto, String buscar)
{
    if (texto == null) return false;
    if (buscar.Length > texto.Length) return false;

    for (int i = 0; i <= texto.Length - buscar.Length; i++)
    {
        bool encontrado = true;
        for (int j = 0; j < buscar.Length; j++)
        {
            if (texto.Chars[i + j] != buscar.Chars[j])
            {
                encontrado = false;
                break;
            }
        }
        if (encontrado) return true;
    }
    return false;
}
function room_Start()
{
    gGui1.Visible = false; // Se oculta inmediatamente al entrar
}
function room_AfterFadeIn()
{
  gGui1.Visible = false;
    // Reproducir música de créditos
    aZambolino___Spiritus_in_Me__freetouse_com__credits.Play();
    

    // Variables
    int yPos = 480;
    int speed = 1;
    bool finished = false;
    int frames = 0;

    // Colores
    int colorTitle = 15;
    int colorCategory = 2;
    int colorWhite = 16;
    int colorGreen = 3;
    int colorGray = 23;
    int colorBlack = 16;

    // Array de créditos
    String credits[60];
    
    // Inicializar todo el array a "" para evitar null
    for (int i = 0; i < 60; i++) credits[i] = "";

    // Contenido de créditos
    credits[0] = "CRÉDITOS";
    credits[2] = "MÚSICA";
    credits[4] = "Música Interiores";
    credits[5] = "por Andrés Mediavilla Rodríguez";
    credits[7] = "Castle";
    credits[8] = "por Walen";
    credits[9] = "Fuente: https://freetouse.com/music";
    credits[10] = "Música de fondo gratuita (No Copyright)";
    credits[12] = "Spiritus in Me";
    credits[13] = "por Zambolino";
    credits[14] = "Fuente: https://freetouse.com/music";
    credits[15] = "Música para videos (Descarga Gratuita)";
    credits[17] = "Dark atmosphere with rain";
    credits[18] = "por Milagros Gómez";
    credits[19] = "Fuente: https://pixabay.com/music";
    credits[22] = "EFECTOS DE SONIDO";
    credits[24] = "Place Holder Assets";
    credits[25] = "por Mayra";
    credits[28] = "SPRITES";
    credits[30] = "Luis Carlos Rodríguez Pérez";
    credits[31] = "Jacob Gabriel Núñez Marapacuto";
    credits[34] = "FONDOS";
    credits[36] = "Jacob Gabriel Núñez Marapacuto";
    credits[37] = "Luis Carlos Rodríguez Pérez";
    credits[38] = "Ángela Yuqiang Leal Gorrachategui";
    credits[41] = "PROGRAMACIÓN";
    credits[43] = "Ángela Yuqiang Leal Gorrachategui";
    credits[44] = "Jiale Lin";
    credits[45] = "Andrés Mediavilla Rodríguez";
    credits[46] = "Izan Huesca Gordo";
    credits[49] = "Gracias por jugar";
    credits[51] = "Trabajo para Guión y Narración.";

    int totalCredits = 54;

    // Obtener superficie del fondo
    DrawingSurface *bg = Room.GetDrawingSurfaceForBackground();

    while (!finished)
    {
        frames++;

        int currentY = yPos;

        // Dibujar créditos
        for (int i = 0; i < totalCredits; i++)
        {
            if (credits[i] != null && credits[i] != "" && currentY > -30 && currentY < 510)
            {
                int textColor = 15; // blanco por defecto
                if (credits[i] == "CRÉDITOS" || credits[i] == "Gracias por jugar") textColor = 14;
                else if (credits[i] == "MÚSICA" || credits[i] == "EFECTOS DE SONIDO" || 
                         credits[i] == "SPRITES" || credits[i] == "FONDOS" || 
                         credits[i] == "PROGRAMACIÓN") textColor = 13;
                else if (StringContains(credits[i], "por ")) textColor = 9;
                else if (StringContains(credits[i], "Fuente:") || credits[i] == "© 2024 Tu Estudio") textColor = 7;

                bg.DrawingColor = textColor;
                bg.DrawStringWrapped(70, currentY, 500, eFontFont3, eAlignCenter, credits[i]);
            }
            currentY += 30;
        }

        // Mensaje ESC transparente
        if (frames > 90 && (frames / 10) % 2 == 0)
        {
            bg.DrawingColor = 15; // blanco
            bg.DrawStringWrapped(440, 455, 190, eFontFont3, eAlignCenter, "ESC para saltar");
        }

        // Liberar superficie para actualizar el fondo
        bg.Release();

        // Scroll de créditos
        yPos -= speed;

        // Salir si termina scroll o se presiona ESC/Space
        if (yPos < -2000 || IsKeyPressed(eKeyEscape) || IsKeyPressed(eKeySpace))
            finished = true;

        Wait(1);

        // Volver a obtener superficie para el siguiente frame
        bg = Room.GetDrawingSurfaceForBackground();
    }

    FadeOut(10);
    player.ChangeRoom(5);
}
