// room script file

function room_FirstLoad()
{
  cSrReed.Say("¿Me permiten sus abrigos?");
  cPaxton.Say("Claro");
  cBarnes.Walk(469, cSrReed.y, eBlock);
  //cBarnes.ChangeView(5);
  cBarnes.Walk(570, 411, eBlock);
  Wait(2);
  cPaxton.Walk(469, cSrReed.y, eBlock);
  //cPaxton.ChangeView(4);
  cPaxton.Walk(530, 377, eBlock);
//Las hermanas dan al sr. Reed sus abrigos
  //cSrReed.ChangeView(6);
  cSrReed.Say("Bueno, traeré algo de beber y mientras tanto ¿seríais tan amables de encender la vela que está en la mesa? ");
  cBarnes.Say("Disculpe Sr. Reed, no podemos porque no tenemos nada con que encenderla. ");
  cSrReed.Say("Oh, no se preocupe creo que tengo cerillas en el armario.");
  cSrReed.Say("Pero hay un problema, y es que solo se abre con una combinación extraña");
  cSrReed.Say("y sólo recuerdo esta adivinanza para abrirlo ``en la estrella descansa una señora mientras mira la Luna ´´. ");
  cPaxton.Say("Haremos lo que podamos");
//el sr. Reed se va hacia el pasillo
  cSrReed.Walk(57, 412, eBlock);
  cSrReed.ChangeRoom(4);
}

//Armario
function hArmario_Look(Hotspot *theHotspot, CursorMode mode)
{
  cPaxton.Say("Hay unas ranuras.");
  gArmarioActivado = 1;
  cPaxton.Say("Parece que hay que poner algo para abrirla");
}

function hArmario_Interact(Hotspot *theHotspot, CursorMode mode)
{
  if(gArmarioPos1==1 && gArmarioPos2 == 1 && gArmarioPos3==1){//PUESTOS en el correcto orden las figuras
    cPaxton.ChangeRoomAutoPosition(4);
    cBarnes.ChangeRoom(4, 293, 396, eDirectionDown);
    cSrReed.ChangeRoom(1);
  }else{
  cPaxton.Say("No consigo abrirlo.");
  gArmarioActivado = 1;
  }
}

//Figura de la virgen maría
function oVirgenMaria_Look(Object *theObject, CursorMode mode)
{
if(gArmarioActivado==0){
  cPaxton.Say("Es una figura de la Virgen María.");
}else {cPaxton.Say("Esta figura podría caber en la ranura.");}
  //si se activa el puzzle PAXTON: Esta figura podría caber en la ranura. 
}

function oVirgenMaria_PickUp(Object *theObject, CursorMode mode)
{
  cPaxton.Walk(oVirgenMaria.X, oVirgenMaria.Y,  eBlock);//448, 375
  cPaxton.FaceObject(oVirgenMaria);
  oVirgenMaria.Visible = false;
  cPaxton.AddInventory(iVirgenMaria);
  if(gArmarioActivado == 0){ //Si no ha mirado las ranuras
    cPaxton.Say("Recuerdo que aparece en la adivinanza, puede que nos sirva.");
  }
}


//Cuadro luna
function oLuna_Look(Object *theObject, CursorMode mode)
{
  //cPaxton.Walk(oLuna.X, oLuna.Y, eBlock);//252, 390
  cPaxton.Say("Es un cuadro de la luna menguante.");
  
}
function oLuna_PickUp(Object *theObject, CursorMode mode)
{
  cPaxton.Walk(oLuna.X, oLuna.Y,  eBlock);//252, 390
  cPaxton.FaceObject(oLuna);
  oLuna.Visible = false;
  cPaxton.AddInventory(iLuna);
  if(gArmarioActivado == 0){ //Si no ha mirado las ranuras
    cPaxton.Say("Recuerdo que aparece en la adivinanza, puede que nos sirva.");
  }
}

//Cuadros 1 y 2
function oCuadro1_Look(Object *theObject, CursorMode mode)
{
  cPaxton.Say("Es un cuadro de una iglesia.");
}
function oCuadro1_PickUp(Object *theObject, CursorMode mode)
{
  cPaxton.Say("Esto no me sirve para nada.");
}

function oCuadro2_Look(Object *theObject, CursorMode mode)
{
  cPaxton.Say("Es un cuadro de una montaña.");
}

function oCuadro2_PickUp(Object *theObject, CursorMode mode)
{
  cPaxton.Say("Esto no me sirve para nada.");
}

//Estrella
function oEstrella_Look(Object *theObject, CursorMode mode)
{
  //cPaxton.Walk(oEstrella.X, oEstrella.Y,  eBlock);
  if(gArmarioActivado==1){
  cPaxton.Say("Esta estrella no parece ni muy grande");
  cPaxton.Say("ni muy pequeña para las ranuras.");
  } else {
    cPaxton.Say("Es una estrella.");
  }
}
function oEstrella_PickUp(Object *theObject, CursorMode mode)
{
  cPaxton.Walk(oEstrella.X, oEstrella.Y,  eBlock);
  cPaxton.FaceObject(oEstrella);
  oEstrella.Visible = false;
  cPaxton.AddInventory(iEstrella);
  if(gArmarioActivado == 0){ //Si no ha mirado las ranuras
    cPaxton.Say("Recuerdo que aparece en la adivinanza, puede que nos sirva.");
  }
}

//Vela apagada
function oVelaApagada_Look(Object *theObject, CursorMode mode)
{
  cPaxton.Say("Es la vela que deberíamos encender. ");
}
function oVelaApagada_Interact(Object *theObject, CursorMode mode)
{
  cPaxton.Say("Aún no puedo encender la vela,"); 
  cPaxton.Say("debería mirar en el armario por las cerrillas. ");
}

//Puerta de la entrada
function hEntrada_Interact(Hotspot *theHotspot, CursorMode mode)
{
  cBarnes.Say("Hermana Paxton recuerde que no podemos ");
  cBarnes.Say("abandonar el salón sin nuestros abrigos.");
}

//COMBINACIÓN RANURAS DEL ARMARIO
function hRanuraEstrella_UseInv(Hotspot *theHotspot, CursorMode mode)
{
  if(player.ActiveInventory == iEstrella){
    cPaxton.LoseInventory(iEstrella);
    oEstrella.SetPosition(163, 228);
    oEstrella.Visible = true;
    gArmarioPos1=1;
    cPaxton.Say("Esta sí va aquí.");
  }else{
    cPaxton.Say("Esta no va aquí.");
  }
  
  if(gArmarioPos3==1 && gArmarioPos2==1){
    Display("Clack");
    cPaxton.Say("Ahora podemos abrir el armario.");
  }
}
function hRanuraFigura_UseInv(Hotspot *theHotspot, CursorMode mode)
{
  if(player.ActiveInventory == iVirgenMaria){
    cPaxton.LoseInventory(iVirgenMaria);
    oVirgenMaria.SetPosition(165, 276);
    oVirgenMaria.Visible = true;
    gArmarioPos2 = 1;
    cPaxton.Say("Esto sí va aquí.");
  } else{
    cPaxton.Say("Esto no va aquí.");
  }
  
  if(gArmarioPos1==1 && gArmarioPos3==1){
    cPaxton.Say("Ahora podemos abrir el armario.");
  }
}
function hRanuraLuna_UseInv(Hotspot *theHotspot, CursorMode mode)
{
  if(player.ActiveInventory == iLuna){
    cPaxton.LoseInventory(iLuna);
    oFigLuna.Visible = true;
    gArmarioPos3 = 1;
    cPaxton.Say("Esto sí va aquí.");
  } else{
    cPaxton.Say("Esto no va aquí.");
  }
  
  if(gArmarioPos1==1 && gArmarioPos2==1){
    Display("Clack");
    cPaxton.Say("Ahora podemos abrir el armario.");
  }
}


